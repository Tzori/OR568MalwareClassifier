install.packages("tree")
library(tree)


#load the data
dataCS = read.csv('/Users/18043/Downloads/Kaggle-data-FINAL.csv')

#check that data was loaded
head(dataCS)
summary(dataCS)
nrow(dataCS)

#model of classification tree..
tree.CS = tree(legitimate~MajorLinkerVersion+SizeOfCode+CheckSum, data = dataCS)
summary(tree.CS)

#put graphs in 1 row and 1 column
par(mfrow = c(1, 1))

#plot the tree
plot(tree.CS)
text(tree.CS, pretty = 0)

#print detailed summary of tree
tree.CS


nrow(dataCS)*.8

set.seed(568)
train=sample(1:nrow(dataCS), nrow(dataCS)*.8)


tree.CStrain = tree(as.factor(legitimate)~MajorLinkerVersion+SizeOfCode+CheckSum, data = dataCS, subset=train)
summary(tree.CStrain)
#plot the tree
plot(tree.CStrain)
text(tree.CStrain, pretty = 0)


#predict it on the test set
tree.predict = predict(tree.CStrain, dataCS[-train,], type="class")

#misclassification table
with(dataCS[-train,], table(tree.predict, legitimate))

#use misclassification error as the basis for pruning
cv.treeCS = cv.tree(tree.CStrain, FUN = prune.misclass)
plot(cv.treeCS)

prune.cvtree = prune.misclass(tree.CStrain, best = 12)
plot(prune.cvtree)
text(prune.cvtree, pretty=0)



tree.predict = predict(prune.cvtree, dataCS[-train,], type="class")

#misclassification table
with(dataCS[-train,], table(tree.predict, legitimate))


