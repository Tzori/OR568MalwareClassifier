FINALdata = read.csv('/Users/18043/Downloads/Kaggle-data-FINAL.csv')
head(FINALdata)

#create PCA without ID and non-numeric column or the predictor
FINALshortPR <- prcomp(FINALdata[c(3:56)], center = TRUE, scale = TRUE)

# Summary
summary(FINALshortPR)


#set plot
par(mfrow=c(1,1))

#regular scree plot
percentVariancePCA = FINALshortPR$sd^2/sum(FINALshortPR$sd^2)*100
plot(percentVariancePCA, xlab="Components", ylab="Percentage of Total Variance", type="l", main="Scree Plot of PCA Analysis")

#set plot
par(mfrow=c(1,2))

#see if we can remove where eigenvalue is less than 1
screeplot(FINALshortPR, type = "l", npcs = 40, main = "Screeplot of the first 40 PCs")
abline(h = 1, col = "red", lty=5)
legend("topright", legend=c("Eigenvalue=1"),
       col=c("red"), lty=5, cex=0.6)

cumpro <- cumsum(FINALshortPR$sdev^2 / sum(FINALshortPR$sdev^2))
plot(cumpro[0:40], xlab = "PC #", ylab = "Amount of explained variance", main = "Cumulative variance plot")
abline(v = 20, col="blue", lty=5)
abline(h=0.73456, col="blue", lty=5)
legend("topleft", legend=c("Cut-off @ PC20"),
       col=c("blue"), lty=5, cex=0.6)

#set plot
par(mfrow=c(1,1))

#we only account for 12% of variance with first 2 principal components
plot(FINALshortPR$x[,1], FINALshortPR$x[,2], xlab="PC1 (6.502%)", ylab = "PC2 (6.325%)", main=" PC1 / PC2 - plot")


install.packages("factoextra")
library("factoextra")
fviz_pca_ind(FINALshortPR, geom.ind = "point", pointshape = 21, 
             pointsize = 2, 
             fill.ind = factor(FINALdata$legitimate), 
             col.ind = "black", 
             palette = "jco", 
             addEllipses = TRUE,
             label = "var",
             col.var = "black",
             repel = TRUE,
             legend.title = "Legitimate") +
  ggtitle("2D PCA-plot") +
  theme(plot.title = element_text(hjust = 0.5))
fviz_pca_ind

