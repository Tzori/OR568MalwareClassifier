#===============================================================================
# Libraries
library(dplyr)
library(ggplot2)
#===============================================================================
# Load File from Directory
cwd <- getwd()
file.name <- "model_metrics.csv"
paste(cwd, file.name ,sep="/")
df <- read.csv(paste(cwd, file.name ,sep="/"))
data.load <- df
#===============================================================================
colnames(df)
df %>% arrange(desc(Kappa)) %>% select(Model.Type, Kappa, Accuracy, Author)
#===============================================================================
# Visualizations
#===============================================================================
ggplot(df, aes(x = Accuracy, y = AUC)) +
  geom_point() +
  labs(x = "Accuracy", y = "AUC")
#-------------------------------------------------------------------------------
ggplot(df, aes(x = Accuracy, y = Kappa)) +
  geom_point() +
  labs(x = "Accuracy", y = "Kappa")
#-------------------------------------------------------------------------------
df.kappa <- subset(df, Kappa > 0.8)
ggplot(df.kappa, aes(x = Kappa, y = Accuracy, color = Model.Type))+
  geom_point(size = 2.5) +
  labs(x = "Kappa", y = "Accuracy", color = "Model Type",
       title = "Kappa Metric vs Accuracy", 
       subtitle = "All Models of Kappa > 0.8") +
  geom_vline(xintercept = 1.0, linetype = "dashed", color = "black") +
  geom_hline(yintercept = 1.0, linetype = "dashed", color = "black") +
  coord_cartesian(xlim = c(0.75, 1.05))

# install.packages("ggbeeswarm")
library(ggbeeswarm)

ggplot(df.kappa, aes(x = Kappa, y = Accuracy, color = Model.Type)) +
  geom_beeswarm(size = 3, alpha = 0.9, dodge.width = 0.2) +
  labs(x = "Kappa", y = "Accuracy", color = "Model Type",
       title = "Kappa Metric vs Accuracy", 
       subtitle = "All Models of Kappa > 0.8 | BeeSwam Library") +
  geom_vline(xintercept = 1.0, linetype = "dashed", color = "black") +
  geom_hline(yintercept = 1.0, linetype = "dashed", color = "black")

#-------------------------------------------------------------------------------
# Accuracy Comparisons
ggplot(df, aes(x = reorder(Model.Type, Accuracy), y = Accuracy, fill = Model.Type)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label=Accuracy), vjust=-.25, hjust=1.2, color="black", size=3.5) +
  labs(x = "Model Type", y = "Accuracy", fill = "Model Type", 
       title="Model Accuracy Comparisons") +
  coord_flip() +
  theme(legend.position = 'none')

# Kappa comparisons
ggplot(df, aes(x = reorder(Model.Type, Kappa), y = Kappa, fill = Model.Type)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label=Kappa), vjust=-.25, hjust=1.2, color="black", size=3.5) +
  labs(x = "Model Type", y = "Kappa", fill = "Model Type",
       title="Model Kappa Comparisons") +
  coord_flip() +
  theme(legend.position = 'none')

# Time Visuals
ggplot(df, aes(x = reorder(Model.Type, -Time.Minutes), y = Time.Minutes, fill = Model.Type)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label=Time.Minutes), vjust=0.25, hjust=-.001, color="black", size=3.5) +
  labs(x = "Model Type", y = "Time.Minutes", fill = "Model Type",
       title="Model Run Time Comparisons (in Minutes)") +
  coord_flip() +
  theme(legend.position = 'none')


#-------------------------------------------------------------------------------