## Logistic Regression
##
install.packages("pscl")


#load the data
FINALdata = read.csv('/Users/18043/Downloads/Kaggle-data-FINAL.csv')
head(FINALdata)

summary(FINALdata)
nrow(FINALdata)

set.seed(568)

#Use 70% of dataset as training set and remaining 30% as testing set
sample <- sample(c(TRUE, FALSE), nrow(FINALdata), replace=TRUE, prob=c(0.7,0.3))
train <- FINALdata[sample, ]
test <- FINALdata[!sample, ] 



#fit logistic regression model
model <- glm(legitimate~SizeOfCode+MajorLinkerVersion, family="binomial", data=train)

#disable scientific notation for model summary
options(scipen=999)

#view model summary
summary(model)

#R^2 value
pscl::pR2(model)["McFadden"]

#variable importance
caret::varImp(model)

#calculate VIF to see if multicolinearity is a problem
car::vif(model)
#VIF above 5 indicate sever multicolinearity

#
predicted <- predict(model, test, type="response")


