# Random Forest Model A

This repository contains the code for training and evaluating Random Forest Model A using the provided dataset. The code performs preprocessing steps, trains the model, and evaluates its performance. This model yielded our highest accuracy and kappa statistic metrics throughout this project's repository.

## Preprocessing

The preprocessing steps for Random Forest Model A are as follows:

1. Load the dataset by setting the working directory and reading the CSV file.
2. Label the response variable column as "legitimate".
3. Check for null values in the dataset.
4. Check for near-zero variance using the `nearZeroVar` function.
5. Drop the columns with near-zero variance.
6. Check the class of each attribute and drop the "md5" column as it is not needed.
7. Find highly correlated variables and remove those with a correlation magnitude of 0.8 or higher.
8. Perform a test-train split with a 70/30 ratio.
9. Create the train and test sets, removing the "legitimate" column from both.
10. Prepare the X and Y variables for training and testing.

## Random Forest Model A

The Random Forest Model A is trained and evaluated using the following steps:

1. Load the required `randomForest` library.
2. Set the seed for reproducibility and record the start time.
3. Train the random forest model (`rfModel`) using the training data (`x_train` and `y_train`) with 600 trees.
4. Record the end time and calculate the time taken for training.
5. View the trained random forest model.
6. Plot the random forest model.
7. Evaluate the model's performance on the training data by predicting the labels (`rf_yHat_train`) and calculating the post-resampling results (`rfModelTrainResults`).
8. Predict the labels for the test data (`x_test`) using the trained model (`rfModel`) and store the results in `rf_yHat`.
9. Evaluate the model's performance on the test data by calculating the post-resampling results (`rfPR`).
10. Plot the ROC curve and calculate the AUC score using the `pROC` package.
11. Plot the confusion matrix to assess the model's performance.
12. Calculate the variable importance using the `varImp` function and store the results in `varImpRand`.
13. Create a data frame (`var_df_rand`) with variable names and importance scores.
14. Sort the data frame by importance scores in descending order.
15. Plot the variable importance using a bar plot.

## Additional Visualization

The code includes an additional plot that visualizes one of the trees in the random forest model using the `getTree` function.

Please refer to the code comments and the code itself for more details on each step.


## Table of Contents

- [Link to Main README](/readMeIndv/README.md)
- [Bagging-Boosting-Script.R](/readMeIndv/Bagging-Boosting-Script.md)
- [citations.R](/readMeIndv/citations_script.md)
- [data_preprocess.R](/readMeIndv/data_preprocess.md)
- [DecisionTree_Script.R](/readMeIndv/DecisionTree_Script.md)
- [LR_Script.R](/readMeIndv/LR_Script.md)
- [model_metrics.R](/readMeIndv/model_metrics_readme.md)
- [pca_Script.R](/readMeIndv/pca_Script.md)
- [rfe_Script.R](/readMeIndv/rfe_Script.md)
- [SVM_script.R](/readMeIndv/SVM_script.md)
- [template_script.R](/readMeIndv/template_script.md)
