install.packages("AppliedPredictiveModeling")
install.packages("dplyr")
install.packages("tidyr")
install.packages("Correlplot")
install.packages(lattice)
install.packages(caret)
library(lattice)
library(AppliedPredictiveModeling)
library(dplyr)
library(tidyr)
library(ggplot2)
library(corrplot)
library(caret)
library(e1071)

Kdatafinal <- read.csv("C:/R projects/OR-568 - Spring 2023/Malware detection project/Kaggle-data-FINAL.csv")
View(kdatafinal)
str(Kdatafinal)
nearZeroVar(Kdatafinal)
malwaredf<- Kdatafinal[, -2]
malwaredf
# Find out the lenght of the data frame
print(length(malwaredf))
splom(malwaredf)
cor(malwaredf)
CorrPlot <- cor(malwaredf)
corrplot
#find out the mean of cor(malwaredf)
#1. Check PCA eligibility. After running the mean, I get 0.0423 as result which
#is high;therefore it is eligible for PCA
mean(cor(malwaredf)) # mean checks for the avg correlaion between the variables.
#2. Principal Component Analysis
malwarePCA = princomp(malwaredf)
#It shows that the correlation between variables and the loading creation should equal to the variables
malwarePCA$loadings
#Create an object (PCmalware) to check if variables are dependent or not.If they are independent the correlation among 
#the components must be zero or must be nearly zero.
pcmalware = malwarePCA$scores
View(pcmalware)
cor(pcmalware)


# Summary
summary(malwarePCA)
summary(pcmalware)
#CorrPlot <- cor(malwarePCA)
#corrplot
